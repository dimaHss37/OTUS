* ## Настраиваем сервер NFS:

192.168.122.181 - будет сервер
192.168.122.246 - будет клиент

* Установим сервер NFS:
```sh
apt install nfs-kernel-server
```

* Проверяем наличие слушающих портов:

```sh
ss -tnplu

tcp   LISTEN 0      4096         0.0.0.0:2049       0.0.0.0:*
tcp   LISTEN 0      4096            [::]:2049          [::]:*
udp   UNCONN 0      0            0.0.0.0:111        0.0.0.0:*    users:(("rpcbind",pid=2787,fd=5),("systemd",pid=1,fd=445))
udp   UNCONN 0      0               [::]:111           [::]:*    users:(("rpcbind",pid=2787,fd=7),("systemd",pid=1,fd=447))
tcp   LISTEN 0      4096         0.0.0.0:111        0.0.0.0:*    users:(("rpcbind",pid=2787,fd=4),("systemd",pid=1,fd=444))
tcp   LISTEN 0      4096            [::]:111           [::]:*    users:(("rpcbind",pid=2787,fd=6),("systemd",pid=1,fd=446))
```

* Создаём и настраиваем директорию, которая будет экспортирована в будущем:
```sh
mkdir -p /srv/share/upload
chown -R nobody:nogroup /srv/share/
chmod 0777 /srv/share/upload/
```

* Cоздаём в файле /etc/exports структуру, которая позволит экспортировать ранее созданную директорию:
```sh
cat << EOF > /etc/exports
/srv/share 192.168.122.246/32(rw,sync,root_squash)
EOF
```

* Экспортируем ранее созданную директорию:
```sh
exportfs -r
```

* Проверяем экспортированную директорию:
```sh
exportfs -s
/srv/share  192.168.122.246/32(sync,wdelay,hide,no_subtree_check,sec=sys,rw,secure,root_squash,no_all_squash)
```

* ## Настраиваем клиент NFS

* Установим пакет с NFS-клиентом:
```sh
sudo apt install nfs-common
```

* Добавляем в /etc/fstab строку:
```sh
echo "192.168.122.181:/srv/share/ /mnt nfs vers=3,noauto,x-systemd.automount 0 0" >> /etc/fstab
```

* Выполняем команды:
```sh
systemctl daemon-reload
systemctl restart remote-fs.target
```


* Проверяем успешность монтирования:
```sh
mount | grep mnt
nsfs on /run/snapd/ns/prompting-client.mnt type nsfs (rw)
nsfs on /run/snapd/ns/snapd-desktop-integration.mnt type nsfs (rw)
nsfs on /run/snapd/ns/firefox.mnt type nsfs (rw)
systemd-1 on /mnt type autofs (rw,relatime,fd=80,pgrp=1,timeout=0,minproto=5,maxproto=5,direct,pipe_ino=79982)
```

* ## Проверка работоспособности

* Заходим на сервер, заходим в каталог r/srv/share/upload , создаём  файл "hello".

```sh
cd /srv/share/upload/
touch hello
```

* Заходим на клиент, заходим в каталог /mnt/upload , проверяем наличие ранее созданного файла.
```sh
cd /mnt/upload/
ls
hello
```

* Создаём тестовый файл "hello2", проверяем, что файл успешно создан.
```sh
ouch hello2
ls
hello  hello2
```
